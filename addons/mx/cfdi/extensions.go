package cfdi

import (
	"github.com/invopop/gobl/cbc"
	"github.com/invopop/gobl/i18n"
	"github.com/invopop/gobl/pkg/here"
)

// Mexican CFDI extension keys required by the SAT (tax authority in Mexico) in all
// invoices and cannot be determined automatically.
const (
	ExtKeyIssuePlace   cbc.Key = "mx-cfdi-issue-place"
	ExtKeyPostCode     cbc.Key = "mx-cfdi-post-code"
	ExtKeyFiscalRegime cbc.Key = "mx-cfdi-fiscal-regime"
	ExtKeyUse          cbc.Key = "mx-cfdi-use"
	ExtKeyProdServ     cbc.Key = "mx-cfdi-prod-serv"     // name from XML field: ClaveProdServ
	ExtKeyRelType      cbc.Key = "mx-cfdi-rel-type"      // name from XML field: TipoRelacion
	ExtKeyDocType      cbc.Key = "mx-cfdi-doc-type"      // name from XML field: TipoDeComprobante
	ExtKeyTaxType      cbc.Key = "mx-cfdi-tax-type"      // name from XML field: TipoImpuesto
	ExtKeyPaymentMeans cbc.Key = "mx-cfdi-payment-means" // name from XML field: FormaPago
)

var extensions = []*cbc.KeyDefinition{
	{
		Key: ExtKeyDocType,
		Name: i18n.String{
			i18n.EN: "Document Type",
			i18n.ES: "Tipo de Comprobante",
		},
		Values: []*cbc.ValueDefinition{
			{
				Value: "I",
				Name: i18n.String{
					i18n.EN: "Invoice",
					i18n.ES: "Comprobante de Ingreso",
				},
			},
			{
				Value: "E",
				Name: i18n.String{
					i18n.EN: "Credit Note",
					i18n.ES: "Comprobante de Egreso",
				},
			},
		},
	},
	{
		Key: ExtKeyRelType,
		Name: i18n.String{
			i18n.EN: "Relation Type",
			i18n.ES: "Tipo de Relación",
		},
		Values: []*cbc.ValueDefinition{
			{
				Value: "01",
				Name: i18n.String{
					i18n.EN: "Credit note for related documents",
					i18n.ES: "Nota de crédito de los documentos relacionados",
				},
			},
			{
				Value: "02",
				Name: i18n.String{
					i18n.EN: "Debit note for related documents",
					i18n.ES: "Nota de débito de los documentos relacionados",
				},
			},
			{
				Value: "03",
				Name: i18n.String{
					i18n.EN: "Return of goods for related documents",
					i18n.ES: "Devolución de mercancía sobre los documentos relacionados",
				},
			},
			{
				Value: "04",
				Name: i18n.String{
					i18n.EN: "Substitution of the previous CFDI document",
					i18n.ES: "Sustitución de los CFDI previos",
				},
			},
			{
				Value: "05",
				Name: i18n.String{
					i18n.EN: "Transfer of goods for related documents",
					i18n.ES: "Traslados de mercancías facturados por los documentos relacionados",
				},
			},
			{
				Value: "06",
				Name: i18n.String{
					i18n.EN: "Invoice generated by previous transfers",
					i18n.ES: "Factura generada por los traslados previos",
				},
			},
			{
				Value: "07",
				Name: i18n.String{
					i18n.ES: "CFDI por aplicación de anticipo",
					i18n.EN: "CFDI for advance payment",
				},
			},
		},
	},
	{
		Key: ExtKeyIssuePlace,
		Name: i18n.String{
			i18n.EN: "Place of Issue",
			i18n.ES: "Lugar de Expedición",
		},
		Desc: i18n.String{
			i18n.EN: here.Doc(`
				Post code of where the invoice was issued. In CFDI, this translates to the 'LugarExpedicion'.
			`),
			i18n.ES: here.Doc(`
				Código postal de donde se emitió la factura. En CFDI se traduce a 'LugarExpedicion'.
			`),
		},
		Pattern: "^[0-9]{5}$",
	},
	{
		Key: ExtKeyPostCode,
		Name: i18n.String{
			i18n.EN: "Post Code",
			i18n.ES: "Código Postal",
		},
		Desc: i18n.String{
			i18n.EN: here.Doc(`
				Post code of a supplier or customer to use instead of an address. Example: "01000".
			`),
			i18n.ES: here.Doc(`
				Código postal de un emisor o receptor para usar en lugar de una dirección. Ejemplo: "01000".
			`),
		},
		Pattern: "^[0-9]{5}$",
	},
	{
		Key: ExtKeyTaxType,
		Name: i18n.String{
			i18n.EN: "Tax Type",
			i18n.ES: "Tipo de Impuesto",
		},
		Desc: i18n.String{
			i18n.EN: here.Doc(`
				Code defined in the CFDI catalogue "c_Impuesto" for the type of tax. Used in the 'Impuesto' field.
			`),
			i18n.ES: here.Doc(`
				Código definido en el catálogo del CFDI "c_Impuesto" para el tipo de impuesto. Usado en el campo 'Impuesto'.
			`),
		},
		Values: []*cbc.ValueDefinition{
			{
				Value: "001",
				Name: i18n.String{
					i18n.EN: "Income Tax",
					i18n.ES: "Impuesto Sobre la Renta",
				},
			},
			{
				Value: "002",
				Name: i18n.String{
					i18n.EN: "Value Added Tax",
					i18n.ES: "Impuesto al Valor Agregado",
				},
			},
			{
				Value: "003",
				Name: i18n.String{
					i18n.EN: "Special Tax on Production and Services",
					i18n.ES: "Impuesto Especial sobre Producción y Servicios",
				},
			},
		},
	},
	{
		Key: ExtKeyProdServ,
		Name: i18n.String{
			i18n.EN: "Product or Service Code",
			i18n.ES: "Clave de Producto o Servicio", //nolint:misspell
		},
		Desc: i18n.String{
			i18n.EN: here.Doc(`
				Code defined in the CFDI catalogue used to identify a product or service.
				Mapped to the 'ClaveProdServ' CFDI field.
			`),
			i18n.ES: here.Doc(`
				Código definido en el catálogo del CFDI utilizado para identificar un producto o servicio.
				Mapeado al campo del CFDI 'ClaveProdServ'.
			`),
		},
	},
	{
		Key: ExtKeyFiscalRegime,
		Name: i18n.String{
			i18n.EN: "Fiscal Regime Code",
			i18n.ES: "Código de Régimen Fiscal",
		},
		Desc: i18n.String{
			i18n.EN: "Fiscal regime associated with suppliers and customers.",
			i18n.ES: "Régimen fiscal asociado con el emisor y receptor.",
		},
		Values: []*cbc.ValueDefinition{
			{
				Value: "601",
				Name: i18n.String{
					i18n.ES: "General de Ley Personas Morales",
				},
			},
			{
				Value: "603",
				Name: i18n.String{
					i18n.ES: "Personas Morales con Fines no Lucrativos",
				},
			},
			{
				Value: "605",
				Name: i18n.String{
					i18n.ES: "Sueldos y Salarios e Ingresos Asimilados a Salarios",
				},
			},
			{
				Value: "606",
				Name: i18n.String{
					i18n.ES: "Arrendamiento",
				},
			},
			{
				Value: "607",
				Name: i18n.String{
					i18n.ES: "Régimen de Enajenación o Adquisición de Bienes",
				},
			},
			{
				Value: "608",
				Name: i18n.String{
					i18n.ES: "Demás ingresos",
				},
			},
			{
				Value: "610",
				Name: i18n.String{
					i18n.ES: "Residentes en el Extranjero sin Establecimiento Permanente en México",
				},
			},
			{
				Value: "611",
				Name: i18n.String{
					i18n.ES: "Ingresos por Dividendos (socios y accionistas)", //nolint:misspell
				},
			},
			{
				Value: "612",
				Name: i18n.String{
					i18n.ES: "Personas Físicas con Actividades Empresariales y Profesionales",
				},
			},
			{
				Value: "614",
				Name: i18n.String{
					i18n.ES: "Ingresos por intereses",
				},
			},
			{
				Value: "615",
				Name: i18n.String{
					i18n.ES: "Régimen de los ingresos por obtención de premios",
				},
			},
			{
				Value: "616",
				Name: i18n.String{
					i18n.ES: "Sin obligaciones fiscales",
				},
			},
			{
				Value: "620",
				Name: i18n.String{
					i18n.ES: "Sociedades Cooperativas de Producción que optan por diferir sus ingresos",
				},
			},
			{
				Value: "621",
				Name: i18n.String{
					i18n.ES: "Incorporación Fiscal",
				},
			},
			{
				Value: "622",
				Name: i18n.String{
					i18n.ES: "Actividades Agrícolas, Ganaderas, Silvícolas y Pesqueras",
				},
			},
			{
				Value: "623",
				Name: i18n.String{
					i18n.ES: "Opcional para Grupos de Sociedades",
				},
			},
			{
				Value: "624",
				Name: i18n.String{
					i18n.ES: "Coordinados",
				},
			},
			{
				Value: "625",
				Name: i18n.String{
					i18n.ES: "Régimen de las Actividades Empresariales con ingresos a través de Plataformas Tecnológicas",
				},
			},
			{
				Value: "626",
				Name: i18n.String{
					i18n.ES: "Régimen Simplificado de Confianza",
				},
			},
		},
	},
	{
		Key: ExtKeyUse,
		Name: i18n.String{
			i18n.EN: "CFDI Use Code",
			i18n.ES: "Código de Uso CFDI",
		},
		Desc: i18n.String{
			i18n.EN: "Chosen by the customer to indicate the purpose of an invoice.",
			i18n.ES: "Elegido por el cliente para indicar el propósito de una factura.",
		},
		Values: []*cbc.ValueDefinition{
			{
				Value: "G01",
				Name: i18n.String{
					i18n.EN: "Acquisition of goods",
					i18n.ES: "Adquisición de mercancías",
				},
			},
			{
				Value: "G02",
				Name: i18n.String{
					i18n.EN: "Returns, discounts or rebates",
					i18n.ES: "Devoluciones, descuentos o bonificaciones",
				},
			},
			{
				Value: "G03",
				Name: i18n.String{
					i18n.EN: "General expenses",
					i18n.ES: "Gastos en general",
				},
			},
			{
				Value: "I01",
				Name: i18n.String{
					i18n.EN: "Construction",
					i18n.ES: "Construcciones",
				},
			},
			{
				Value: "I02",
				Name: i18n.String{
					i18n.EN: "Office furniture and equipment as investmen",
					i18n.ES: "Mobiliario y equipo de oficina por inversiones",
				},
			},
			{
				Value: "I03",
				Name: i18n.String{
					i18n.EN: "Transport equipment",
					i18n.ES: "Equipo de transporte",
				},
			},
			{
				Value: "I04",
				Name: i18n.String{
					i18n.EN: "Computer equipment and accessories",
					i18n.ES: "Equipo de computo y accesorios",
				},
			},
			{
				Value: "I05",
				Name: i18n.String{
					i18n.EN: "Dies, punches, molds, matrices and other toolin",
					i18n.ES: "Dados, troqueles, moldes, matrices y herramental",
				},
			},
			{
				Value: "I06",
				Name: i18n.String{
					i18n.EN: "Telephone communications",
					i18n.ES: "Comunicaciones telefónicas",
				},
			},
			{
				Value: "I07",
				Name: i18n.String{
					i18n.EN: "Satellite communications",
					i18n.ES: "Comunicaciones satelitales",
				},
			},
			{
				Value: "I08",
				Name: i18n.String{
					i18n.EN: "Other machinery and equipment",
					i18n.ES: "Otra maquinaria y equipo",
				},
			},
			{
				Value: "D01",
				Name: i18n.String{
					i18n.EN: "Medical and dental fees and hospital expenses",
					i18n.ES: "Honorarios médicos, dentales y gastos hospitalarios",
				},
			},
			{
				Value: "D02",
				Name: i18n.String{
					i18n.EN: "Medical expenses for disability or incapacity",
					i18n.ES: "Gastos médicos por incapacidad o discapacidad",
				},
			},
			{
				Value: "D03",
				Name: i18n.String{
					i18n.EN: "Funeral expenses",
					i18n.ES: "Gastos funerales",
				},
			},
			{
				Value: "D04",
				Name: i18n.String{
					i18n.EN: "Donations",
					i18n.ES: "Donativos",
				},
			},
			{
				Value: "D05",
				Name: i18n.String{
					i18n.EN: "Interest actually paid on mortgage loans (housing)",
					i18n.ES: "Intereses reales efectivamente pagados por créditos hipotecarios (casa habitación)",
				},
			},
			{
				Value: "D06",
				Name: i18n.String{
					i18n.EN: "Voluntary contributions to the SAR",
					i18n.ES: "Aportaciones voluntarias al SAR",
				},
			},
			{
				Value: "D07",
				Name: i18n.String{
					i18n.EN: "Medical insurance premiums",
					i18n.ES: "Primas por seguros de gastos médicos",
				},
			},
			{
				Value: "D08",
				Name: i18n.String{
					i18n.EN: "Mandatory school transportation expenses",
					i18n.ES: "Gastos de transportación escolar obligatoria",
				},
			},
			{
				Value: "D09",
				Name: i18n.String{
					i18n.EN: "Deposits in savings accounts, pension plans premiums",
					i18n.ES: "Depósitos en cuentas para el ahorro, primas que tengan como base planes de pensiones",
				},
			},
			{
				Value: "D10",
				Name: i18n.String{
					i18n.EN: "Payments for educational services (school fees)",
					i18n.ES: "Pagos por servicios educativos (colegiaturas)",
				},
			},
			{
				Value: "S01",
				Name: i18n.String{
					i18n.EN: "Without tax effects",
					i18n.ES: "Sin efectos fiscales",
				},
			},
			{
				Value: "CP01",
				Name: i18n.String{
					i18n.EN: "Payments",
					i18n.ES: "Pagos",
				},
			},
			{
				Value: "CN01",
				Name: i18n.String{
					i18n.EN: "Payroll",
					i18n.ES: "Nómina",
				},
			},
		},
	},
	{
		Key: ExtKeyPaymentMeans,
		Name: i18n.String{
			i18n.EN: "Payment Means",
			i18n.ES: "Forma de Pago",
		},
		Desc: i18n.String{
			i18n.EN: here.Doc(`
				Code defined in the CFDI catalogue "c_FormaPago" for the payment method. Used in the 'FormaPago' field.
			`),
			i18n.ES: here.Doc(`
				Código definido en el catálogo del CFDI "c_FormaPago" para el método de pago. Usado en el campo 'FormaPago'.
			`),
		},
		Values: []*cbc.ValueDefinition{
			{
				Value: "01",
				Name: i18n.String{
					i18n.EN: "Cash",
					i18n.ES: "Efectivo",
				},
			},
			{
				Value: "02",
				Name: i18n.String{
					i18n.EN: "Check",
					i18n.ES: "Cheque nominativo",
				},
			},
			{
				Value: "03",
				Name: i18n.String{
					i18n.EN: "Electronic Funds Transfer",
					i18n.ES: "Transferencia electrónica de fondos",
				},
			},
			{
				Value: "04",
				Name: i18n.String{
					i18n.EN: "Credit Card",
					i18n.ES: "Tarjeta de crédito",
				},
			},
			{
				Value: "05",
				Name: i18n.String{
					i18n.EN: "Electronic Wallet",
					i18n.ES: "Monedero electrónico",
				},
			},
			{
				Value: "06",
				Name: i18n.String{
					i18n.EN: "Online or Electronic Payment",
					i18n.ES: "Dinero electrónico",
				},
			},
			{
				Value: "08",
				Name: i18n.String{
					i18n.EN: "Grocery Voucher",
					i18n.ES: "Vales de despensa",
				},
			},
			{
				Value: "12",
				Name: i18n.String{
					i18n.EN: "Payment in Kind",
					i18n.ES: "Dación en pago",
				},
			},
			{
				Value: "13",
				Name: i18n.String{
					i18n.EN: "Payment by subrogation",
					i18n.ES: "Pago por subrogación",
				},
			},
			{
				Value: "14",
				Name: i18n.String{
					i18n.EN: "Payment by consignment",
					i18n.ES: "Pago por consignación",
				},
			},
			{
				Value: "15",
				Name: i18n.String{
					i18n.EN: "Debt relief",
					i18n.ES: "Condonación",
				},
			},
			{
				Value: "17",
				Name: i18n.String{
					i18n.EN: "Netting",
					i18n.ES: "Compensación",
				},
			},
			{
				Value: "23",
				Name: i18n.String{
					i18n.EN: "Novation",
					i18n.ES: "Novación",
				},
			},
			{
				Value: "24",
				Name: i18n.String{
					i18n.EN: "Merger",
					i18n.ES: "Confusión",
				},
			},
			{
				Value: "25",
				Name: i18n.String{
					i18n.EN: "Debt remission",
					i18n.ES: "Remisión de deuda",
				},
			},
			{
				Value: "26",
				Name: i18n.String{
					i18n.EN: "Expiration of payment obligation",
					i18n.ES: "Prescripción o caducidad",
				},
			},
			{
				Value: "27",
				Name: i18n.String{
					i18n.EN: "To the creditor's satisfaction",
					i18n.ES: "A satisfacción del acreedor",
				},
			},
			{
				Value: "28",
				Name: i18n.String{
					i18n.EN: "Debit card",
					i18n.ES: "Tarjeta de débito",
				},
			},
			{
				Value: "29",
				Name: i18n.String{
					i18n.EN: "Services card",
					i18n.ES: "Tarjeta de servicios",
				},
			},
			{
				Value: "30",
				Name: i18n.String{
					i18n.EN: "Advance payment",
					i18n.ES: "Aplicación de anticipos",
				},
			},
			{
				Value: "31",
				Name: i18n.String{
					i18n.EN: "Payment via intermediary",
					i18n.ES: "Intermediario pagos",
				},
			},
			{
				Value: "99",
				Name: i18n.String{
					i18n.EN: "Undefined",
					i18n.ES: "Por definir",
				},
			},
		},
	},
}
